---
date: 2017-07-20 09:15
status: public
title: Git 入门指北
tags: Git, 开发工具
---

前两天给工作室里大一的小朋友讲了一遍 Git 的基础知识，趁着还能记得，想把这样的分享记录下来，整理成一遍文章。演讲用的 keynote 在此：[点击下载](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/Git%20基础.key)。演讲大纲如下：

* Git 是什么
* Git 怎么用
* Git 与团队协作

<!--more-->

# Git 是什么
在回答 Git 是什么这个问题之前，我们首先需要知道版本控制是什么？

版本控制其实很好理解， 版本控制系统就是对一个文件、文件系统的历史节点版本进行保存、回退等控制管理的系统。

在 Mac 里，很多原生的应用都会自带一个我们理解的版本控制系统。就拿 keynote 为例子，打开一份 keynote 文件，点击 文件->复原到...->浏览所有版本，可以看到这样的一个界面。

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/WechatIMG102.jpeg)

这就是 Mac 应用里自带的版本控制系统，我们可以在右边的时间轴里随时找回此文件的不同历史版本，恢复到历史的某个版本来。

那么在代码版本管理这里，我们用的是什么工具呢？在以前，CVS 和 SVN 都是比较流行版本控制系统，直到 Git 开始流行之前，SVN 还是一个是十分广泛使用的版本控制。SVN 与 Git 的差别是，SVN 是一种集中式的版本控制系统，而 Git 是一种分布式的版本控制系统。

有些刚入门的小朋友很容易搞混的两个概念是「Git」和「GitHub」。Git 的概念如上文所述，而 GitHub 呢，实际上可以理解成一个社区，一个开源（当然也有一部分不开源的）代码的社区。在 GitHub 这个社区里，大家使用 Git 这个工具，将自己的代码共享到 GitHub 中去。当然 GitHub 在使用 Git 的时候也和基本的 Git 有一些区别，这些以后再讲。

# Git 怎么用
讲完了 Git 的作用，我们来讲讲 Git 的使用。 

## 先了解几个概念

首先，在讲解 Git 使用之前，我觉得你必须掌握「终端模拟器」这个工具。

打开 Spotlight， 搜索『终端』或者「terminal」，就可以打开 Mac 上的终端模拟器。在终端模拟器里运行着一个叫做 shell 的软件。shell（「壳」的意思）这个软件会和计算机的内核进行通讯，用户通过在界面输入命令，达到和计算机进行通讯的功能。

Git 的命令行使用需要用到 Terminal。在 Terminal 中输入 `git <命令>` 如 `git status` 即可执行一条 git 命令。

接着讲讲 Git 使用前还需要了解的 Git 知识：Git 的四个区和 Git 分支。

当我们初始化一个 Git 之后，我们会得到一个 Git 的版本库。Git 中，用四个区，分别是「工作目录」、「暂存区」、「本地版本」、「远端版本」。

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/QQ20170720-094243.png)

工作目录是程序员平时在 IDE 里修改代码的时候实际工作的区域。当我们修改文件的时候，直接影响到了工作目录下的文件。当我们使用 `git add` 时，可以将工作目录下的文件版本同步到暂存区里去，使用 `git commit` 命令，则可以将代码发布到本地仓库中去。这样就完成了本地代码的一次更新。使用 `git push` 则可以将本地的代码发送到远端仓库中去，这样你就可以和同伴们共享自己修改的代码了。

Git 分支实际上也是一个比较好理解的概念。当我们创建一个 Git 仓的时候，默认会生成一个 master 分支。在我们平时开发过程中，我们可能需要添加某些功能，可能每个人负责的功能不同，那么我们会在一个节点上，开出几个不同的分支，当我们开发完毕的时候再把它们合并在一起。这是分支使用的一个例子。

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/QQ20170720-094926.png)

## Git 的基本命令

终于要开始使用 Git 了。首先你需要安装 Git，如果你已经安装了最新的 Xcode，那恭喜你，你也已经安装好了 Git。如果你的 Mac 没有 Xcode，我倒是建议你安装一个。

Git 的基本命令我觉得有如下几条：

* 添加与提交

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/QQ20170720-095502.png)

* 推送改动

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/QQ20170720-095538.png)

* 分支操作

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/QQ20170720-095557.png)

* 其他操作

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/QQ20170720-095624.png)

## 怎样开始一个 Git 项目？

讲解一个东西最直观的方法还是开始一个 Demo。下面将演示一下 Git 使用的几个不同场景。

* 本地->远端
* 远端->本地
* 分支操作
* 冲突解决

前面两点解决的是「怎么开始一个 Git 项目」，分别从两种场景来讲。后面两点是解决 Git 使用过程会遇到的两个场景。

* 本地->远端
在本地创建一个空的 Git 仓库，需要使用 `git init` 命令。在终端中，使用 `cd <目录>` 进入你想要工作的空目录，在改目录下使用 `git init` 命令创建一个空的 Git 仓库。

创建仓库后，在 finder 查看该目录好像并没有什么变化。那是因为 `git init` 执行之后创建了一个隐藏的 .git 文件，在 finder 里默认是无法查看的。使用 `ls -ah` 命令可以在 终端里查看到该目录下的隐藏文件和文件夹。

接着，你就可以在工作目录下添加、修改你的代码。当你在编译器或者 IDE 里完成了修改之后，可以使用 `git add *` 将代码同步到暂存区中（还记得吧，这是第二个区），当你确定要提交这个代码版本到本地仓库时，使用 `git commit -m <提交信息>` 将此时的代码同步到本地仓库中去。为了方便了解本次提交修改或者添加了什么内容，提交信息需要填写本次提交的基本信息。关于提交信息的书写规范，在下文会描述。

OK，这样你的本地仓库就有你最新的代码了。接着，你需要将本地的代码发布到远程仓库中，这样你就可以和你的同伴一起协作开发了。首先你需要添加一个远程仓库 `git remote add origin <server>` 然后使用 `git push origin master` 就可以将 master 分支 push 到 origin 远端仓库中。

* 远端->本地

从远端将代码拉动到本地需要用 `git clone <server>` 将远程的仓库下载到本地。完成修改之后，可以用上文相同的方式将代码同步到远程。

* 分支操作

在 Git 里面管理代码一定离不开分支的操作。常见的分支操作包括创建新的分支、检出分支、合并分支。命令如下：

```
／／ 创建并检出新的分支
git checkout -b search
／／ 切换分支
git checkout master
／／ 查看分支情况
git branch
／／ 合并分支
git merge search
```

* 合并冲突

「冲突」在新手听起来可能是一件可怕的事情，但其实当我们遇到并解决它的时候并没有那么可怕。冲突的产生往往是因为两个不同的分支在不同的节点里进行了不一样的操作。当操作者把这两条分支合并在一起的时候，Git 并不知道要保留哪个分支下的版本，于是就产生了一个冲突。

产生冲突的文件会以下格式的代码出现：

```
<<<<<<< HEAD
master hahahah
=======
search hahahahh
>>>>>>> search
```

新手看到这个可能有点怕，但是不用担心，这个东西很容易。在这个文件的这段代码代表：在当前分支下的代码为 `master hahahah` 在 search 这个分支下，代码则是 `search hahahahh`，请解决这个冲突。解决办法也很简答，你只要删除其中一个就可以。比如我想保留 HEAD 下的版本，那么只留下：

```
master hahahah
```

OK，然后使用 commit 命令提交代码即可。

* Git 的其他操作

Git 还有很多其他操作。比如：

```
git tag
git stash
git status
git reset
```

这些一般我会使用可视化的工具 SourceTree 里管理，所以这里也不多累赘。

* 重要

我使用 Git 里有一句我觉得挺重要的结论，就是：**Git 的高级操作是由基本操作组合完成的**。掌握基本命令并灵活使用，可以完成 Git 的高级操作，比如说删除分支的某次提交。

# Git 与团队协作

OK，终于到了 Git 的实战阶段。我们使用 Git 很多时候和同伴一起使用。在 Git 中有着一些大家默认遵守的 Git 使用和管理的方法，使用这样的方法可以让我们的代码管理更加有条有理。有以下两点：

* Git Flow
* Git Commit

## Git Flow
狭义来讲，Git Flow 是指 Git 的分支管理方法。如果不加以管理，团队在提交代码的时候，可能会不知道远端仓库的情况

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/WechatIMG103.jpeg)

使用规范的 Git Flow，可以做到规范的提交 Git 分支，如下：

![](http://chanjh.b0.upaiyun.com/iOSHub/iOSHubBlog/0006/WechatIMG110.jpeg)

每个分支的功能都不同：

* master——最为稳定功能最为完整的随时可发布的代码；
这个分支只能从其他分支合并，不能在这个分支直接修改

* develop——永远是功能最新最全的分支；
这个分支是我们是我们的主开发分支，包含所有要发布到下一个Release的代码，这个主要合并与其他分支，比如Feature分支

* hotfix——修复线上代码的 bug；
当我们在Production发现新的Bug时候，我们需要创建一个Hotfix, 完成Hotfix后，我们合并回Master和Develop分支，所以Hotfix的改动会进入下一个Release

* feature——某个功能点正在开发阶段；
这个分支主要是用来开发一个新的功能，一旦开发完成，我们合并回Develop分支进入下一个Release

* release——发布定期要上线的功能。
当你需要一个发布一个新Release的时候，我们基于Develop分支创建一个Release分支，完成Release后，我们合并到Master和Develop分支

更多详情的介绍，可以查看文末的链接。

## Git Commit

Git Commit 是对 Git 的提交信息进行规范的一种约定。方便开发协作者查看每次修改的内容和重要性。具体格式如下：

```
Header
		feat：新功能（feature）
		fix：修补bug
		docs：文档（documentation）
		style： 格式（不影响代码运行的变动）
		refactor：重构（即不是新增功能，也不是修改bug的代码变动）
		test：增加测试
		chore：构建过程或辅助工具的变动

Body
Footer
```

同样的， Git Commit 的更多内容可以查看文末链接。

# 参考文章

* [廖雪峰的 Git 教程](https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)
* [Git Pro](https://git-scm.com/book/zh/v2)
* [Git 简明教程](rogerdudler.github.io/git-guide/index.zh.html)
* [Git Flow](blog.yvesluo.cc/2017/01/25/GitFlow/)
* [Git Commit](blog.yvesluo.cc/2017/01/25/Git之正确的commit姿势/)
